[TOC]
# eBPF
1. 不修改内核; 不使用内核模块; 使得内核动态执行字节码
2. 用户态进程, 通过系统调用得 `bpf()`
   把 **bpf 程序** 编译为字节码, 加载到内核中
   内核通过安全校验后, JIT 编译器把字节码编译为机器码
   后续在特定的事件回调中, 执行 bpf 程序
3. supported event hooks: syscall / tracepoint / kernel-function / user-function

# bpf
1. bpf 在 内核函数/系统调用/库函数/软件事件/硬件事件 等钩子点 插桩采样
2. 主要采样 入参出参返回值, 通过控制采样的 时间间隔/事件频率 等辅助统计
3. 原生的 bpf 使用库为 bcc; 支持 c++ / python / lua 三种语言的封装
4. bcc 的编程方式是:
    1. 用c语言实现回调
    2. 用封装把上一步骤的回调安装
    3. 在封装中可以控制采样 时间间隔/事件频率; 重整采样结果
5. bpftrace 是一个 high level 的语言封装, 语法形式类似 awk, 超级便利
    1. 为原生采样点实现 少数几个命令即可完成的采样
    2. 支持 时间间隔/事件频率 控制
    3. 支持 直方图/分布图 两种统计形式的输出
6. 无论何种形式的采样, 需要对内核函数工作流程有本质理解